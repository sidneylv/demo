// Generated by CoffeeScript 1.8.0
var kit, nobone, noboneDir, renderer, service, _ref;

process.env.NODE_ENV = 'development';

nobone = require('./nobone');

_ref = nobone(), kit = _ref.kit, service = _ref.service, renderer = _ref.renderer;

noboneDir = kit.path.join(__dirname, '..');

service.use(renderer.staticEx({
  rootDir: noboneDir,
  index: true
}));

service.get('/favicon.ico', function(req, res) {
  var noboneFavicon;
  noboneFavicon = kit.path.join(__dirname, '/../assets/img/nobone.png');
  return res.sendFile(noboneFavicon);
});

module.exports = function(opts) {
  return service.listen(opts.port, function() {
    var port, url;
    port = service.server.address().port;
    url = "http://127.0.0.1:" + port + "/readme.md?offlineMarkdown";
    console.log("Please Visit: ".cyan + url);
    if (opts.openDir) {
      return kit.open(url)["catch"](function() {});
    }
  });
};
